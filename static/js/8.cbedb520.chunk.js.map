{"version":3,"sources":["components/charts/simplePieChart.tsx","components/playerDetails/charts/winLoseDistribution.tsx"],"names":["DEFAULT_COLORS","RADIAN","Math","PI","renderCustomizedLabelFactory","lineHeight","innerLabelFontSize","props","value","lines","toString","trim","split","viewBox","cx","cy","outerRadius","startAngle","radius","angle","x","cos","y","sin","polarToCartesian","endAngle","sign","min","abs","getDeltaAngle","yStart","length","map","text","index","key","stroke","strokeWidth","fill","fontSize","textAnchor","dominantBaseline","defaultInnerLabel","item","innerLabel","defaultOuterLabel","outerLabel","SimplePieChart","items","outerLabelOffset","innerLabelLineHeight","colors","aspect","cells","useMemo","Array","_","fillOpacity","renderCustomizedLabel","wrappedOuterLabel","ret","offsetRadius","width","height","isAnimationActive","data","nameKey","dataKey","label","valueAccessor","undefined","position","content","buildItems","stats","keys","labels","total","sum","formatPercent","filter","WinLoseDistribution","t","useTranslation","winData","loseData","loseSelfData","result","selfOther","放铳时副露率","放铳时立直率","push","className"],"mappings":"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","file":"static/js/8.cbedb520.chunk.js","sourcesContent":["import React from \"react\";\nimport { ResponsiveContainer, PieChart, Pie, Cell, LabelList, LabelProps, PolarViewBox } from \"recharts\";\nimport { useMemo } from \"react\";\n\nconst DEFAULT_COLORS = [\"#003f5c\", \"#7a5195\", \"#ef5675\", \"#ffa600\"];\n\nconst getDeltaAngle = (startAngle: number, endAngle: number) => {\n  const sign = Math.sign(endAngle - startAngle);\n  const deltaAngle = Math.min(Math.abs(endAngle - startAngle), 360);\n\n  return sign * deltaAngle;\n};\n\nconst RADIAN = Math.PI / 180;\n\nconst polarToCartesian = (cx: number, cy: number, radius: number, angle: number) => ({\n  x: cx + Math.cos(-RADIAN * angle) * radius,\n  y: cy + Math.sin(-RADIAN * angle) * radius\n});\n\nconst renderCustomizedLabelFactory = ({ lineHeight = 24, innerLabelFontSize = \"1rem\" }) => (props: LabelProps) => {\n  const { value } = props;\n  if (!value) {\n    return null;\n  }\n  const lines = value\n    .toString()\n    .trim()\n    .split(\"\\n\");\n  const { cx, cy, outerRadius, startAngle, endAngle } = props.viewBox as Required<PolarViewBox>;\n  const labelAngle = startAngle + getDeltaAngle(startAngle, endAngle) / 2;\n  const { x, y } = polarToCartesian(cx, cy, outerRadius / 2, labelAngle);\n  const yStart = y - (lines.length - 1) * (lineHeight / 2);\n  return (\n    <g>\n      {lines.map((text, index) => (\n        <text\n          key={index}\n          x={x}\n          y={yStart + index * lineHeight}\n          stroke=\"#fff\"\n          strokeWidth=\"0.5\"\n          fill=\"#fff\"\n          fontSize={innerLabelFontSize}\n          textAnchor=\"middle\"\n          dominantBaseline=\"central\"\n        >\n          {text}\n        </text>\n      ))}\n    </g>\n  );\n};\n\nexport type PieChartItem = {\n  value: number;\n  innerLabel?: string;\n  outerLabel?: string;\n};\n\nfunction defaultInnerLabel<T extends PieChartItem>(item: T) {\n  return item.innerLabel || \"\";\n}\nfunction defaultOuterLabel<T extends PieChartItem>(item: T) {\n  return item.outerLabel || \"\";\n}\n\ndeclare module \"recharts\" {\n  interface LabelListProps {\n    fill?: string;\n  }\n}\n\nexport default function SimplePieChart<T extends PieChartItem>({\n  items,\n  innerLabel = defaultInnerLabel,\n  outerLabel = defaultOuterLabel,\n  outerLabelOffset = 0,\n  innerLabelLineHeight = 24,\n  startAngle = 0,\n  colors = DEFAULT_COLORS,\n  innerLabelFontSize = \"1rem\",\n  aspect = 1\n}: {\n  items: T[];\n  innerLabel?: (item: T) => string;\n  outerLabel?: (item: T) => string;\n  outerLabelOffset?: number;\n  innerLabelLineHeight?: number;\n  startAngle?: number;\n  colors?: string[];\n  innerLabelFontSize?: string;\n  aspect?: number;\n}) {\n  const cells = useMemo(\n    () =>\n      Array(items.length)\n        .fill(0)\n        .map((_, index) => <Cell fill={colors[index % colors.length]} fillOpacity={1} key={`cell-${index}`} />),\n    [items.length, colors]\n  );\n  const renderCustomizedLabel = useMemo(\n    () => renderCustomizedLabelFactory({ lineHeight: innerLabelLineHeight, innerLabelFontSize }),\n    [innerLabelLineHeight, innerLabelFontSize]\n  );\n  const wrappedOuterLabel = useMemo(() => {\n    const ret = (item: T) => outerLabel(item);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (ret as any).offsetRadius = outerLabelOffset;\n    return ret;\n  }, [outerLabel, outerLabelOffset]);\n  return (\n    <ResponsiveContainer width=\"100%\" aspect={aspect} height=\"auto\">\n      <PieChart>\n        <Pie\n          isAnimationActive={false}\n          data={items}\n          nameKey=\"outerLabel\"\n          dataKey=\"value\"\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          label={wrappedOuterLabel as (x: any) => string}\n          startAngle={startAngle}\n          endAngle={startAngle + 360}\n        >\n          {cells}\n          <LabelList\n            valueAccessor={innerLabel}\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            dataKey={undefined as any}\n            position=\"inside\"\n            fill=\"#fff\"\n            content={renderCustomizedLabel}\n          />\n        </Pie>\n      </PieChart>\n    </ResponsiveContainer>\n  );\n}\n","import React from \"react\";\nimport { PlayerExtendedStats, PlayerMetadata } from \"../../../data/types\";\nimport SimplePieChart, { PieChartItem } from \"../../charts/simplePieChart\";\nimport { sum } from \"../../../utils\";\nimport { formatPercent } from \"../../../utils/index\";\nimport { useMemo } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nfunction buildItems(\n  stats: PlayerExtendedStats,\n  keys: (keyof PlayerExtendedStats)[],\n  labels: string[],\n  total = 0\n): PieChartItem[] {\n  total = total || sum(keys.map((key) => (stats[key] as number) || 0));\n  return keys\n    .map((key, index) => ({\n      value: stats[key] as number,\n      outerLabel: labels[index],\n      innerLabel: formatPercent((stats[key] as number) / total),\n    }))\n    .filter((item) => item.value);\n}\n\nexport default function WinLoseDistribution({ stats }: { stats: PlayerExtendedStats; metadata: PlayerMetadata }) {\n  const { t } = useTranslation();\n  const winData = useMemo(() => buildItems(stats, [\"立直和了\", \"副露和了\", \"默听和了\"], [\"立直\", \"副露\", \"默听\"]), [\n    stats,\n  ]);\n  const loseData = useMemo(\n    () => buildItems(stats, [\"放铳至立直\", \"放铳至副露\", \"放铳至默听\"], [\"立直\", \"副露\", \"默听\"]),\n    [stats]\n  );\n  const loseSelfData = useMemo(() => {\n    const result = buildItems(stats, [\"放铳时立直率\", \"放铳时副露率\"], [\"立直\", \"副露\"], 1);\n    const selfOther = {\n      value: 1 - (stats.放铳时副露率 || 0) - (stats.放铳时立直率 || 0),\n      outerLabel: \"门清\",\n    } as PieChartItem;\n    selfOther.innerLabel = formatPercent(selfOther.value / 1);\n    result.push(selfOther);\n    return result.filter((item) => item.value);\n  }, [stats]);\n  return (\n    <div className=\"row\">\n      <div className=\"col-lg-4 mb-2\">\n        <h5 className=\"text-center\">{t(\"和牌时\")}</h5>\n        <SimplePieChart\n          aspect={4 / 3}\n          items={winData}\n          startAngle={-45}\n          innerLabelFontSize=\"0.85rem\"\n          outerLabelOffset={10}\n          outerLabel={(x) => t(x.outerLabel || \"\")}\n        />\n      </div>\n      <div className=\"col-lg-4 mb-2\">\n        <h5 className=\"text-center\">{t(\"放铳时\")}</h5>\n        <SimplePieChart\n          aspect={4 / 3}\n          items={loseSelfData}\n          startAngle={-45}\n          innerLabelFontSize=\"0.85rem\"\n          outerLabelOffset={10}\n          outerLabel={(x) => t(x.outerLabel || \"\")}\n        />\n      </div>\n      <div className=\"col-lg-4 mb-2\">\n        <h5 className=\"text-center\">{t(\"放铳至\")}</h5>\n        <SimplePieChart\n          aspect={4 / 3}\n          items={loseData}\n          startAngle={-45}\n          innerLabelFontSize=\"0.85rem\"\n          outerLabelOffset={10}\n          outerLabel={(x) => t(x.outerLabel || \"\")}\n        />\n      </div>\n    </div>\n  );\n}\n"],"sourceRoot":""}